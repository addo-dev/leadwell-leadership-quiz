<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Leadership Superpower!</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;700&family=IBM+Plex+Serif:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'IBM Plex Sans', sans-serif;
            background-color: #002D40; /* Fallback color */
            background-attachment: fixed;
            overflow-x: hidden;
        }

        body::before, body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-blend-mode: screen;
            z-index: 1;
            filter: blur(80px);
        }

        body::before {
            background: radial-gradient(circle 40vmax at 10% 20%, rgba(73, 207, 233, 0.3), transparent 80%),
                        radial-gradient(circle 30vmax at 80% 10%, rgba(199, 246, 255, 0.2), transparent 80%);
            animation: aurora-flow-1 15s linear infinite;
        }

        body::after {
            background: linear-gradient(320deg, rgba(255, 99, 99, 0.8), rgba(255, 193, 102, 0.8), transparent 70%);
            animation: aurora-flow-2 18s linear infinite;
        }
        
        @keyframes aurora-flow-1 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(20px, 30px) rotate(180deg); }
        }
        @keyframes aurora-flow-2 {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-30px, -20px) rotate(-180deg); }
        }

        .content-layer {
            position: relative;
            z-index: 2;
        }

        .card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.2));
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 2px solid rgba(255, 255, 255, 0.4);
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: inset 0 2px 4px 0 rgba(255, 255, 255, 0.2), 0 10px 25px -3px rgba(0, 0, 0, 0.2);
            max-width: 60rem;
            margin: 2rem auto;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
        }
        
        .primary-button {
            background-color: #002D40;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        .primary-button:hover {
            background-color: #00405c;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        /* Confetti Styles */
        #confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 20px;
            opacity: 0;
            animation: fall 5s linear forwards;
        }
        @keyframes fall {
            0% { transform: translateY(-10vh) rotateZ(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotateZ(720deg); opacity: 0; }
        }
    </style>
</head>
<body class="p-4">
    <div class="mx-auto content-layer" style="max-width: 60rem;">
        <!-- Added an onerror handler to the logo for robustness -->
        <img src="https://devleadwell.wpenginepowered.com/wp-content/uploads/2025/09/Leadwell_Logo_Cyan_Reverse.png" alt="Leadwell Logo" class="w-48 mb-6" onerror="this.onerror=null;this.src='https://placehold.co/192x48/002D40/FFFFFF?text=Leadwell';">
    </div>
    <div class="card text-center content-layer">
        <div id="resultDescription" class="text-lg text-white mt-4 mb-6 text-left">
            <!-- Results will be injected here by JavaScript -->
        </div>
        <a href="index.html" class="primary-button uppercase">Retake Quiz</a>
    </div>

    <div id="confetti-container"></div>
    <!-- Hidden iframe for form submission -->
    <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

    <script>
        // Make sure this URL matches the one from your LATEST deployment
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyk8aMcmcDwBmEC-NGyya1Na6UZ5dNAC6tv_KOO6MgiVEOlQbgr924wUQUEOFxS3_x3og/exec"; 
        const resultDescription = document.getElementById('resultDescription');
        const confettiContainer = document.getElementById('confetti-container');
        const confettiColors = ['#49CFE9', '#FFC166', '#FF6363'];
        let submitted = false;

        // Added onerror handlers to the images below to provide fallbacks
        const resultsText = {
            talent: `
                <p class="text-2xl font-bold mb-4 text-white">You're a Talent Architect</p>
                <p>Your primary focus is on the systems, strategies, and actions that help people grow. You see your team as a dynamic engine, and you are constantly working to build a stronger bench, improve training, and maximize the potential of your people. Your superpower is building a foundation of excellence through your people.</p>
                <p class="mt-2">Grab a resource and a challenge card matching your superpower.</p>
                
            `,
            leadership: `
                <p class="text-2xl font-bold mb-2 text-white">You're a Visionary Leader</p>
                <p>Your primary focus is on guiding, influencing, and inspiring your team. You are a natural motivator who understands that performance is tied to purpose. You excel at coaching, delegating, and setting a clear path forward. Your superpower is empowering others to step into their greatness.</p>
                <p class="mt-2">Grab a resource and a challenge card matching your superpower.</p>
                
            `,
            culture: `
                <p class="text-2xl font-bold mb-4 text-white">You're a Culture Curator</p>
                <p>Your primary focus is on the emotional and social climate of your team. You are the heartbeat of the team, dedicated to ensuring that shared values, behaviors, and norms create an environment where everyone feels like they belong. You believe that a healthy, happy team is the key to success. Your superpower is creating an amazing place to work.</p>
                <p class="mt-2">Grab a resource and a challenge card matching your superpower.</p>
                
            `
        };

        function sendDataToSheet(data) {
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = SCRIPT_URL;
            form.target = 'hidden_iframe';

            // Create a separate hidden input for each key-value pair
            for (const key in data) {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = key;
                input.value = data[key];
                form.appendChild(input);
            }

            document.body.appendChild(form);
            submitted = true;
            form.submit();
            console.log("Submitting data via hidden form:", data);
            document.body.removeChild(form);
        }

        function calculateResults() {
            const params = new URLSearchParams(window.location.search);
            let scores = { talent: 0, leadership: 0, culture: 0 };
            let answers = {};

            for (let i = 1; i <= 10; i++) {
                const question = `q${i}`;
                const answer = params.get(question);
                if (answer) {
                    scores[answer]++;
                    answers[question] = answer;
                }
            }

            let maxScore = 0;
            let resultCategory = 'talent'; // Default result
            for (const category in scores) {
                if (scores[category] > maxScore) {
                    maxScore = scores[category];
                    resultCategory = category;
                }
            }
            
            resultDescription.innerHTML = resultsText[resultCategory];
            
            const submissionData = { ...answers, superpower: resultCategory };
            sendDataToSheet(submissionData);
        }

        function startConfetti() {
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.backgroundColor = confettiColors[Math.floor(Math.random() * confettiColors.length)];
                confetti.style.animationDelay = `${Math.random() * 3}s`;
                confetti.style.animationDuration = `${2 + Math.random() * 3}s`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                confettiContainer.appendChild(confetti);
            }
        }
        
        const card = document.querySelector('.card');
        function handleOrientation(event) {
            const { beta, gamma } = event; 
            const maxTilt = 10;
            const tiltY = (beta ? Math.min(maxTilt, Math.max(-maxTilt, beta)) : 0) / maxTilt;
            const tiltX = (gamma ? Math.min(maxTilt, Math.max(-maxTilt, gamma)) : 0) / maxTilt;
            
            card.style.transform = `perspective(1000px) rotateX(${-tiltY * 5}deg) rotateY(${tiltX * 5}deg)`;
        }

        window.addEventListener('DOMContentLoaded', () => {
            calculateResults();
            startConfetti();

            document.getElementById('hidden_iframe').onload = () => {
                if(submitted){
                    console.log('Successfully submitted to Google Sheet.');
                }
            };

            if (window.DeviceOrientationEvent && 'ontouchstart' in window) {
                window.addEventListener('deviceorientation', handleOrientation);
            }
        });
    </script>

</body>
</html>
